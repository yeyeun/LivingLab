"use strict";(self.webpackChunklab=self.webpackChunklab||[]).push([[715],{74969:(e,t,a)=>{a.d(t,{Cc:()=>r,GQ:()=>d,Q8:()=>c,UX:()=>i,h4:()=>h,jX:()=>x,r:()=>o,yw:()=>n,z5:()=>m});var s=a(86213);const l="".concat("http://223.130.157.92:22222","/chat"),r=async(e,t,a,r)=>(await s.A.post("".concat(l,"/room/create"),r,{params:{userId:e,title:t,type:a}})).data,o=async e=>(await s.A.get("".concat(l,"/room/history/").concat(e))).data,c=async e=>(await s.A.get("".concat(l,"/rooms"),{params:{userId:e}})).data,n=async e=>(await s.A.get("".concat(l,"/room/buy/get"),{params:{buyNo:e}})).data,d=async e=>(await s.A.post("".concat(l,"/room/buy/enter"),e)).data,i=async e=>(await s.A.post("".concat(l,"/room/buy/exit"),e)).data,m=async e=>(await s.A.get("".concat(l,"/room/team/get"),{params:{teamNo:e}})).data,x=async e=>(await s.A.post("".concat(l,"/room/team/enter"),e)).data,h=async e=>(await s.A.post("".concat(l,"/room/team/exit"),e)).data},715:(e,t,a)=>{a.r(t),a.d(t,{default:()=>p});var s=a(65043),l=a(83003),r=a(74969),o=a(70579);const c=e=>{let{onSelectChat:t}=e;const[a,c]=(0,s.useState)(""),n=(0,l.d4)((e=>e.loginSlice)).id;return(0,s.useEffect)((()=>{(0,r.Q8)(n).then((e=>{c(e)}))}),[n]),(0,o.jsx)("div",{className:"h-full",children:a.data&&a.data.length>0?a.data.map((e=>(0,o.jsxs)("div",{className:"py-7 px-5 cursor-pointer hover:bg-gray-100 border-b flex items-center",onClick:()=>t(e),children:[(0,o.jsx)("img",{src:"https://via.placeholder.com/40",alt:"...",className:"w-10 h-10 rounded-full mr-4"}),(0,o.jsxs)("div",{children:[(0,o.jsx)("h2",{className:"text-lg font-bold",children:e.title}),(0,o.jsx)("p",{className:"text-sm text-gray-500",children:"\ucc44\ud305\ubc29 \ub9c8\uc9c0\ub9c9 \uba54\uc138\uc9c0"})]})]},e.roomId))):(0,o.jsx)("div",{className:"p-7 flex items-center",children:"\ucc38\uc5ec \uc911\uc778 \ucc44\ud305\ubc29\uc774 \uc5c6\uc2b5\ub2c8\ub2e4"})})},n=e=>{let{message:t}=e;const{sender:a,message:s}=t,r=(0,l.d4)((e=>e.loginSlice)),{nickname:c}=r;return(0,o.jsx)("div",{children:t.sender===c?(0,o.jsx)("div",{className:"flex justify-end",children:(0,o.jsx)("div",{className:"px-4 py-2 m-1 rounded-3xl text-lg bg-mainColor text-white shadow",children:s})}):(0,o.jsxs)("div",{className:"relative",children:[(0,o.jsx)("span",{className:"absolute top-1.5 left-14 text-sm text-gray-500 transform -translate-y-full ml-2",children:t.sender}),(0,o.jsxs)("div",{className:"flex justify-start items-center ml-2 mt-3",children:[(0,o.jsx)("img",{src:"https://via.placeholder.com/40",alt:"Profile",className:"rounded-full w-10 h-10"}),(0,o.jsx)("div",{className:"px-4 py-2 m-2 rounded-3xl text-lg bg-white text-black shadow",children:s})]})]})})},d=e=>{let{onSend:t}=e;const[a,l]=(0,s.useState)("");return(0,o.jsxs)("form",{onSubmit:e=>{e.preventDefault(),""!==a.trim()&&(t(a),l(""))},className:"flex p-4 bg-white border-t rounded-b",children:[(0,o.jsx)("input",{type:"text",value:a,onChange:e=>{l(e.target.value)},className:"flex-1 p-2 border rounded-3xl text-base",placeholder:"\uba54\uc2dc\uc9c0\ub97c \uc785\ub825\ud558\uc138\uc694"}),(0,o.jsx)("button",{type:"submit",className:"ml-2 p-2 bg-teal-400 hover:bg-teal-500 text-white rounded-lg text-base",children:"\ubcf4\ub0b4\uae30"})]})};var i=a(73216),m=a(35081),x=a.n(m),h=a(20799),u=a.n(h);const f=e=>{let{room:t}=e;const a=(0,i.Zp)(),[c,m]=(0,s.useState)(null),[h,f]=(0,s.useState)([]),[p,b]=(0,s.useState)(!1),g=(0,l.d4)((e=>e.loginSlice)),j=g.nickname;(0,s.useEffect)((()=>{const e=new(x())("http://223.130.157.92:22222/ws"),t=u().over(e);return t.connect({},(e=>{console.log("\uc5f0\uacb0: "+e),m(t)}),(e=>{console.error("\uc5f0\uacb0 \uc5d0\ub7ec: ",e)})),()=>{c&&c.disconnect()}}),[]),(0,s.useEffect)((()=>{(async()=>{try{const e=await(0,r.r)(t.roomId);f(e.data.messageHistory)}catch(e){console.error("\ucc44\ud305 \uae30\ub85d \ubd88\ub7ec\uc624\uae30 \uc2e4\ud328: ",e)}})()}),[t.roomId]),(0,s.useEffect)((()=>{if(!c)return;const e=c.subscribe("/topic/chat/room/".concat(t.roomId),(e=>{const t=JSON.parse(e.body);console.log("\ubc1b\uc740 \uba54\uc2dc\uc9c0:",t),f((e=>[...e,t]))}),(e=>{console.error("\uad6c\ub3c5 \uc2e4\ud328: ",e)}));return()=>{e.unsubscribe()}}),[c,t.roomId]);const y=()=>{b(!p)},{value:v}=(N=t).buyNo?{value:N.buyNo}:N.teamNo?{value:N.teamNo}:N.marketNo?{value:N.marketNo}:N.roomNo?{value:N.roomNo}:{value:""};var N;return(0,o.jsxs)("div",{className:"flex flex-col h-full",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-600 text-white rounded-t",children:[(0,o.jsxs)("div",{className:"text-sm flex items-center",children:[(0,o.jsx)("span",{className:"bg-mainColor px-2 py-1 mr-1 rounded-2xl",children:t.type}),(0,o.jsxs)("span",{className:"hover:underline cursor-pointer",onClick:()=>((e,t)=>{"\uacf5\ub3d9\uad6c\ub9e4"===e&&t?a("/buy/read/".concat(t)):"\ub3d9\ub124\ubaa8\uc784"===e&&t?a("/team/read/".concat(t)):"\ub3d9\ub124\uc7a5\ud130"===e&&t?a("/market/read/".concat(t)):"\uc790\ucde8\ubc29\uc250\uc5b4"===e&&t?a("/shareRoom/read/".concat(t)):alert("\uc0ad\uc81c\ub41c \uac8c\uc2dc\ubb3c\uc785\ub2c8\ub2e4")})(t.type,v),children:[t.title," / \ucc44\ud305\ubc29\ubc88\ud638:",t.roomId]})]}),(0,o.jsxs)("div",{className:"text-sm flex items-center",children:[(0,o.jsx)("span",{className:"bg-white px-2 py-1 ml-1 rounded text-black font-bold",children:"3\uba85 \ucc38\uc5ec\uc911"}),(0,o.jsx)("button",{onClick:y,className:"ml-2 bg-gray-700 hover:bg-gray-500 text-white rounded-full w-8 h-8 flex items-center justify-center",children:"\u2630"})]})]}),(0,o.jsxs)("div",{className:"flex-1 overflow-y-auto p-2 bg-slate-100 relative overflow-x-hidden",children:[h.map(((e,t)=>(0,o.jsx)(n,{message:e},t))),(0,o.jsxs)("div",{className:"absolute top-0 right-0 h-full bg-white shadow-lg transition-transform transform ".concat(p?"translate-x-0":"translate-x-full"," w-1/3"),children:[(0,o.jsxs)("div",{className:"p-4 border-b",children:[(0,o.jsx)("h2",{className:"text-base font-bold",children:"\ucc38\uc5ec\uc790 \ubaa9\ub85d"}),(0,o.jsx)("button",{onClick:y,className:"absolute top-2 right-2 text-gray-600 hover:text-gray-900",children:"\xd7"})]}),(0,o.jsx)("div",{className:"p-4 text-base",children:(0,o.jsxs)("ul",{children:[(0,o.jsx)("li",{children:"\ucc38\uc5ec\uc790 1"}),(0,o.jsx)("li",{children:"\ucc38\uc5ec\uc790 2"})]})})]})]}),(0,o.jsx)(d,{onSend:e=>{if(!c||!e)return;const a={type:"TALK",roomId:t.roomId,message:e,sender:j,userId:g.id};console.log("\ubcf4\ub0b8 \uba54\uc138\uc9c0: ",a),c.send("/app/chat/message",JSON.stringify(a),{})}})]})},p=()=>{const[e,t]=(0,s.useState)(null);return(0,o.jsx)("div",{className:"text-xl flex-grow h-screen flex w-4/5",children:(0,o.jsx)("div",{className:"bg-white w-full rounded h-4/5 shadow-md flex flex-col",children:(0,o.jsx)("div",{className:"flex-grow flex flex-col h-full",children:(0,o.jsxs)("div",{id:"chatall",className:"flex-grow flex h-0",children:[(0,o.jsx)("div",{className:"w-1/3 overflow-y-auto no-scrollbar",children:(0,o.jsx)(c,{onSelectChat:e=>{t(e)}})}),(0,o.jsx)("div",{className:"w-2/3",children:e?(0,o.jsx)(f,{room:e}):(0,o.jsx)("div",{id:"chatwin",className:"flex items-center justify-center h-full border-l border-gray-300",children:(0,o.jsx)("p",{className:"text-gray-600",children:"\ucc44\ud305 \ubaa9\ub85d \uc911 \ucc44\ud305\ud560 \ubc29\uc744 \uc120\ud0dd\ud558\uc138\uc694"})})})]})})})})}}}]);
//# sourceMappingURL=715.b8931301.chunk.js.map